cp Input.fasta Input.raw.fasta
perl ./all_script/steps/Remove_10k.pl
mkdir Step1.Identifying_core_elements
cd Step1.Identifying_core_elements/
mkdir ASB HYP INF UNS integrase PAC
cd ASB
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/ASB/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/ASB/domain.txt Marker.1.txt locus.unsorted.txt ASB && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt ASB && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt ASB.track.gtf &
cd ..
cd HYP
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/HYP/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/HYP/domain.txt Marker.1.txt locus.unsorted.txt HYP && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt HYP && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt HYP.track.gtf &
cd ..
cd INF
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/INF/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/INF/domain.txt Marker.1.txt locus.unsorted.txt INF && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt INF && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt INF.track.gtf &
cd ..
cd UNS
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/UNS/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/UNS/domain.txt Marker.1.txt locus.unsorted.txt UNS && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt UNS && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt UNS.track.gtf &
cd ..
cd integrase
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/integrase/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/integrase/domain.txt Marker.1.txt locus.unsorted.txt integrase && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt integrase && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt integrase.track.gtf &
cd ..
cd PAC
nohup /Path/bin/blastx -query ../../Input.fasta -db ../../all_script/steps/PAC/seq.fa -out out.outfmt6.txt -outfmt "6 qaccver saccver pident length mismatch ppos gapopen qstart qend sstart send evalue bitscore qlen slen ssciname sskingdom staxid qseq sseq" -num_threads 12 -seg no && grep -v -P "\*" out.outfmt6.txt > out.outfmt6.no_star.txt && perl ../../all_script/steps/NEW_seq_aa.pl out.outfmt6.no_star.txt seq_aa.fa && perl ../../all_script/steps/seq_aa_1.pl seq_aa.fa seq_aa_1.fa seq_aa_Marker.txt && sh /Path/iprscan/interproscan-5.25-64.0/interproscan.sh -dp -f tsv -goterms -i seq_aa_1.fa -appl Pfam -iprlookup -o iprscan.output.txt -cpu 12 && cut -f1,6 iprscan.output.txt > pre_iprscan.pfam.txt && cut -f1,13 iprscan.output.txt > pre_iprscan.iprscan.txt && cut -f1,14 iprscan.output.txt > pre_iprscan.GO.txt && perl ../../all_script/steps/to_marker.pl pre_iprscan.pfam.txt pre_iprscan.iprscan.txt pre_iprscan.GO.txt Marker.txt && perl ../../all_script/steps/Marker.1.pl seq_aa_Marker.txt Marker.txt Marker.1.txt && perl ../../all_script/steps/TMP_comm.pl ../../all_script/steps/PAC/domain.txt Marker.1.txt locus.unsorted.txt PAC && sort -t $'\t' -k 4,4 -k 5,5n -k 6,6n locus.unsorted.txt > locus.sorted.txt && perl ../../all_script/steps/NEW_merged.pl locus.sorted.txt locus.merged.txt PAC && perl ../../all_script/steps/TMP_IGV.pl locus.merged.txt PAC.track.gtf &
wait
cd ../..
